
<%	#Get the divisions for the season, run them through pagination, and loop through them.
seasons = params[:season]
unless seasons.blank?
	divisions = division_ids(seasons)
else 
	divisions = division_ids(current_season())
end

# Sort them, paginate them. 
	sorted_and_paginated_divisions = divisions.paginate(:page => params[:page], :per_page => 5)
# Loop through the leagues and tabulate them
	 sorted_and_paginated_divisions.each_with_index do |l,index|
		l = show_league(l,1) %>



<table class="league">
		<h3>Division <%= sorted_and_paginated_divisions[index][:number] %></h3>
		<tr>
			<th>Name</th>
			<th>Played</th>
			<th>Won</th>
			<th>Lost</th>
			<th>Drew</th>
			<th>Points</th>
		</tr>

		<%	l.each do |p| %>
			<tr>
				<td><%= link_to p[:Name], :controller => 'users', :action => 'show', :id => p[:id] %></td>
				<td><%= p[:Played] %></td>
				<td><%= p[:Won] %></td>
				<td><%= p[:Lost] %></td>
				<td><%= p[:Drew] %></td>
				<td><%= p[:Points] %></td>
			</tr>
		<% end %>
		</table>


<% 	end  %>




	 

	
<%= will_paginate sorted_and_paginated_divisions %>